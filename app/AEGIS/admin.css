/* Admin styles (uses variables from styles.css) */
.admin-main{ padding: 1.25rem 0; }
.admin-section{ background:#fff; border:1px solid #E5E7EB; border-radius:14px; padding:1rem; margin:1rem 0; box-shadow:var(--shadow) }
.admin-grid-4{ display:grid; grid-template-columns:1fr; gap:1rem }
.kpi{ background:#fff; border:1px dashed #CBD5E1; border-radius:12px; padding:1rem }
.kpi-title{ color:var(--muted); font-weight:600 }
.kpi-value{ font-size:1.8rem; font-weight:800; color:var(--primary-600) }
.mini-bar{ height:6px; background:#F1F5F9; border-radius:99px; overflow:hidden; margin-top:.5rem }
.mini-bar span{ display:block; height:100%; width:var(--v); background:linear-gradient(90deg, var(--primary), #8B5CF6) }

.sim-head{ display:flex; align-items:center; justify-content:space-between; gap:.5rem }
.sim-grid{ display:grid; grid-template-columns:1fr; gap:1rem }
.sim-card{ border:1px solid #E5E7EB; border-radius:12px; padding:1rem; background:#F8FAFC }
.attack-banner{ background:linear-gradient(90deg, rgba(239,68,68,.1), rgba(239,68,68,.02)); border:1px solid #FCA5A5; border-radius:12px; padding: .75rem 1rem; margin-top:1rem }
.btn-danger{ background: var(--danger); color:#fff }

.head-row{ display:flex; align-items:center; justify-content:space-between; gap:.5rem }
.filters{ display:flex; gap:.5rem; flex-wrap:wrap }
.chip{ border:1px solid #CBD5E1; background:#fff; border-radius:999px; padding:.3rem .7rem; cursor:pointer }
.chip.active{ background:#EEF2FF; border-color: var(--primary); }

.feed{ display:grid; gap:.5rem; margin-top:.75rem }
.feed-item{ display:grid; grid-template-columns: 1fr auto; background:#fff; border:1px solid #E5E7EB; border-radius:12px; padding:.6rem .8rem }
.feed-meta{ color:var(--muted); font-size:.9rem }
.badge{ display:inline-block; padding:.15rem .45rem; font-size:.75rem; border-radius:6px; border:1px solid #E5E7EB }
.sev-Low{ background:#E5E7EB }
.sev-Med{ background:#FDE68A; border-color:#F59E0B }
.sev-High{ background:#FCA5A5; border-color:#EF4444 }
.sev-Critical{ background:#fecaca; border-color:#dc2626 }

.inc-list{ display:grid; gap:.75rem }
.inc-card{ border:1px solid #E5E7EB; border-radius:12px; padding:1rem; background:#fff; display:grid; gap:.4rem }
.inc-title{ font-weight:700 }
.inc-actions{ display:flex; gap:.5rem; flex-wrap:wrap }

.user-list{ display:grid; gap:.5rem }
.user-card{ border:1px dashed #CBD5E1; border-radius:12px; padding:.8rem; display:grid; gap:.25rem }
.user-meta{ color:var(--muted) }
.user-badges{ display:flex; gap:.4rem; flex-wrap:wrap }

.conn-grid{ display:grid; grid-template-columns:1fr; gap:.75rem }
.conn-card{ border:1px solid #E5E7EB; border-radius:12px; padding:1rem; display:grid; gap:.35rem; background:#fff }
.conn-actions{ display:flex; gap:.5rem; flex-wrap:wrap }
.conn-status.Connected{ color:var(--accent) }
.conn-status.Disconnected{ color:#EF4444 }

.pb-list{ display:grid; grid-template-columns:1fr; gap:.75rem }
.pb-card{ border:1px solid #E5E7EB; border-radius:12px; padding:1rem; background:#fff }

.audit-list{ display:grid; gap:.35rem; margin-top:.6rem }
.audit-item{ font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:.9rem; background:#F8FAFC; border:1px dashed #E5E7EB; border-radius:8px; padding:.4rem .6rem }

.report{ border:1px dashed #CBD5E1; border-radius:12px; padding:1rem; margin-top:.6rem }
.warning{ background:#FEF3C7; border:1px solid #F59E0B; padding:.5rem; border-radius:8px; margin-top:.5rem }

.role-switch{ color:#fff; display:flex; align-items:center; gap:.4rem }
.badge-wrap{ color:#fff; background:rgba(255,255,255,.1); padding:.2rem .5rem; border-radius:999px; margin-left:.5rem }

/* Theater Mode */
.theater .site-header, .theater .admin-section:not(#incidents) { opacity:.25; pointer-events:none }
.theater #incidents{ opacity:1 }

/* Modal re-use from styles.css; badge in landing */
.inc-badge{ display:inline-flex; align-items:center; justify-content:center; min-width:18px; height:18px; font-size:.75rem; background:#EF4444; color:#fff; border-radius:999px; padding:0 6px }

@media (min-width: 768px){
  .admin-grid-4{ grid-template-columns:repeat(4,1fr) }
  .sim-grid{ grid-template-columns:repeat(4,1fr) }
  .conn-grid{ grid-template-columns:repeat(3,1fr) }
  .pb-list{ grid-template-columns:repeat(2,1fr) }
}


/* Live Feed columns */
.feed-header, .feed-item{
  display:grid;
  grid-template-columns: 140px 1fr 1fr 1fr 1fr 80px 90px;
  gap:.5rem;
  align-items:center;
}
.feed-header{ font-weight:700; color:#334155; }
.feed-cell{ overflow:hidden; text-overflow:ellipsis; white-space:nowrap }
.feed-acts{ display:flex; gap:.35rem; justify-content:flex-start; flex-wrap:wrap }
.iconbtn-sm{ border:1px solid #CBD5E1; background:#fff; border-radius:8px; padding:.25rem .4rem; font-size:.9rem; cursor:pointer }
.iconbtn-sm:hover{ background:#F1F5F9 }
.feed-item[data-flag="impossible"]{ outline:2px solid #EF4444; background: #fff5f5 }

.badge-risk{ padding:.15rem .45rem; border-radius:6px; border:1px solid #E5E7EB; font-size:.75rem; display:inline-block; min-width:70px; text-align:center }
.risk-Low{ background:#E5E7EB }
.risk-Med{ background:#FEF3C7; border-color:#F59E0B }
.risk-High{ background:#FFD6A5; border-color:#fb923c }
.risk-Critical{ background:#fecaca; border-color:#dc2626 }

/* Side panel */
.side-panel{ position:fixed; top:0; right:-420px; width:420px; height:100%; background:#fff; border-left:1px solid #E5E7EB; box-shadow: -8px 0 24px rgba(2,6,23,.12); transition:right .25s; z-index:60; display:flex; flex-direction:column }
.side-panel.open{ right:0 }
.sp-backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.25); z-index:50 }
.sp-header{ display:flex; align-items:center; justify-content:space-between; padding:.8rem 1rem; border-bottom:1px solid #E5E7EB }
.sp-body{ padding:1rem; overflow:auto; display:grid; gap:.5rem }
.sp-row{ display:flex; justify-content:space-between; gap:.5rem }
.sp-badges{ display:flex; gap:.35rem; flex-wrap:wrap }
.sp-actions{ display:flex; gap:.5rem; flex-wrap:wrap; margin-top:.5rem }

/* Modal Location content helpers */
.map-badges{ display:flex; gap:.4rem; flex-wrap:wrap; margin:.5rem 0 }
.map-frame{ width:100%; aspect-ratio: 16 / 9; border:0; border-radius:10px; }
.map-footer{ display:flex; gap:.5rem; flex-wrap:wrap; margin-top:.6rem }

/* Popover */
.popover-root{ position:fixed; z-index:70; pointer-events:none; background:#111827; color:#fff; padding:.35rem .5rem; border-radius:8px; font-size:.8rem; opacity:0; transition:opacity .12s }
.popover-root.show{ opacity:1 }

/* Keyboard focus for rows */
.feed-row{ outline:0; }
.feed-row:focus{ box-shadow: 0 0 0 3px rgba(59,130,246,.5) }

@media (max-width: 1000px){
  .feed-header, .feed-item{ grid-template-columns: 120px 1fr 1fr 1fr 1fr 80px 80px }
}
@media (max-width: 820px){
  .feed-header, .feed-item{ grid-template-columns: 100px 1fr 1fr 1fr 1fr 70px 70px }
}
@media (max-width: 680px){
  .feed-header, .feed-item{ grid-template-columns: 1fr }
  .feed-acts{ justify-content:flex-start }
}


/* Live Feed: enriched columns */
.feed{ display:grid; gap:.5rem; margin-top:.75rem }
.feed-item{ display:grid; grid-template-columns: 120px 1.2fr 1fr 1fr 1fr auto 110px; gap:.5rem; align-items:center; background:#fff; border:1px solid #E5E7EB; border-radius:12px; padding:.55rem .7rem; outline:none }
.feed-item:focus{ box-shadow:0 0 0 3px rgba(59,130,246,.35) }
.feed-time{ color:var(--muted); font-size:.9rem }
.feed-user{ display:grid; gap:.2rem }
.feed-user b{ font-weight:700 }
.feed-device, .feed-ip, .feed-loc{ color:#111 }
.feed-actions{ display:flex; gap:.35rem; justify-content:flex-end }
.iconbtn.sm{ width:34px; height:34px; border-radius:10px; border:1px solid #E5E7EB; background:#fff }
.iconbtn.sm:focus{ outline:2px solid var(--primary); outline-offset:2px }

/* risk badges (emoji + color) */
.risk-badge{ display:inline-flex; align-items:center; gap:.35rem; padding:.15rem .45rem; border-radius:999px; border:1px solid #E5E7EB; font-size:.8rem }
.risk-Low{ background:#ECFDF5 }
.risk-Med{ background:#FEF3C7; border-color:#F59E0B }
.risk-High{ background:#FECACA; border-color:#EF4444 }
.risk-Critical{ background:#fee2e2; border-color:#dc2626 }

/* Impossible travel highlight */
.feed-item.impossible{ border-color:#EF4444; box-shadow:0 0 0 2px rgba(239,68,68,.25) inset }

/* Side Panel */
.side-panel{ position:fixed; inset:0; display:none }
.side-panel[aria-hidden="false"]{ display:block }
.side-panel-backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.35) }
.side-panel-sheet{ position:absolute; top:0; right:0; height:100%; width:min(520px, 92vw); background:#fff; border-left:1px solid #E5E7EB; display:grid; grid-template-rows:auto 1fr auto }
.side-panel-header, .side-panel-footer{ padding:.75rem 1rem; border-bottom:1px solid #E5E7EB }
.side-panel-footer{ border-top:1px solid #E5E7EB; border-bottom:none }
.side-panel-body{ padding:1rem; overflow:auto }

/* Popover */
.popover{ position:fixed; z-index:50; background:#111; color:#fff; font-size:.85rem; padding:.45rem .6rem; border-radius:8px; max-width:280px; box-shadow:var(--shadow) }
.popover a{ color:#93c5fd; text-decoration:underline }

/* Small utilities */
.badge-ip{ background:#F1F5F9; border:1px solid #E5E7EB; border-radius:6px; padding:.05rem .35rem; font-family:ui-monospace,monospace }
.badge-flag{ padding:.05rem .35rem; border-radius:6px; border:1px solid #E5E7EB; background:#FEF3C7; color:#92400E }

@media (max-width: 1024px){
  .feed-item{ grid-template-columns: 110px 1.4fr 1fr 1fr 1fr auto 90px }
}
@media (max-width: 768px){
  .feed-item{ grid-template-columns: 1fr; align-items:flex-start }
  .feed-actions{ justify-content:flex-start }
}


/* --- Live Feed Redesigned --- */
.feed{display:flex;flex-direction:column;gap:.75rem;margin-top:.75rem}
.feed-item{display:flex;flex-direction:column;gap:.5rem;background:#fff;border:1px solid #E5E7EB;border-radius:14px;padding:.85rem 1rem;box-shadow:0 1px 0 rgba(17,24,39,.04)}
.feed-head{display:flex;align-items:center;justify-content:space-between;gap:.5rem}
.feed-title{display:flex;align-items:center;gap:.5rem;font-weight:700;color:#111827}
.feed-meta{display:flex;flex-wrap:wrap;gap:.4rem;color:#374151}
.feed-badges{display:flex;flex-wrap:wrap;gap:.4rem}
.feed-grid{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:.6rem}
.feed-kv{display:flex;flex-direction:column;gap:.15rem;font-size:.92rem}
.feed-kv small{color:#6B7280}
.feed-actions{display:flex;flex-wrap:wrap;gap:.4rem}
.feed-actions .btn.sm{padding:.35rem .6rem;border-radius:10px}
.risk-pill{display:inline-flex;align-items:center;gap:.35rem;padding:.15rem .5rem;border-radius:999px;border:1px solid #E5E7EB;font-size:.8rem}
.risk-low{background:#ECFDF5}
.risk-med{background:#FEF3C7;border-color:#F59E0B}
.risk-high{background:#FECACA;border-color:#EF4444}
.risk-critical{background:#fee2e2;border-color:#dc2626}
.feed-foot{display:flex;flex-wrap:wrap;gap:.5rem;color:#6B7280;font-size:.9rem;border-top:1px dashed #E5E7EB;padding-top:.5rem}
@media (max-width: 1024px){ .feed-grid{grid-template-columns:repeat(2,minmax(0,1fr));} }
@media (max-width: 640px){ .feed-grid{grid-template-columns:1fr;} }
